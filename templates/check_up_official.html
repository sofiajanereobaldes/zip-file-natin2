{% extends "base.html" %} <!--jinja code-->

{%block css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/check_up_official.css') }}">
{%endblock%}


{% block header %}
<header class="header" id="mainHeader">
  <div class="header-left">
    <div class="logo">
      <img src="{{ url_for('static', filename='images/cares-high-resolution-logo-transparent (2).png') }}"
           alt="CARES logo" class="logo-image">
    </div>
    <div class="logo-text">
      <span>CARES</span>
    </div>
  </div>

  <nav class="nav">
    <a href="{{ url_for('homepage_bp.home_brgyofficial') }}">Home</a>
    <a href="{{ url_for('announcement_bp.announcement') }}">Announcements</a>
    <a href="{{ url_for('checkup_bp.check_up_log_official') }}" class="active">Check-Up Log</a>
  </nav>

  <div class="header-right">
    <div class="profile-chip" id="profileChip">
      <div class="avatar">{{ user.first_name[0] }}{{ user.last_name[0] }}</div>
      <div class="profile-info">
        <span class="name">{{ user.first_name }} {{ user.last_name }}</span>
        <span class="role">{{ user.position }}</span>
      </div>
      <span class="chevron">â–¾</span>
    </div>
    <div class="profile-menu" id="profileMenu">
      <ul>
        <li data-action="logout">Log Out</li>
      </ul>
    </div>
  </div>
</header>
{% endblock %}
{%block content%}
  <main>
    <section class="page-header">
      <div class="page-title-row">
        <div class="page-icon">ðŸ“‹</div>
        <div>
          <h1>Check-Up Log</h1>
          <p>Manage patient records and appointments</p>
        </div>
      </div>
      <div class="page-summary" id="pageSummary"></div>

      <div class="tabs">
        <button class="tab active" data-tab="log">Medical Log</button>
        <button class="tab" data-tab="appointments">Appointments</button>
      </div>
    </section>

    <!-- LOG SECTION -->
    <section class="section-card" id="section-log">
      <div class="section-header-row">
        <h2>Patient Medical History</h2>
        <span class="meta-text" id="totalPatientsText">Total Patients: 0</span>
      </div>
      <div class="patient-card-grid" id="patientGrid"></div>
    </section>

    <!-- APPOINTMENTS SECTION -->
    <section class="section-card hidden" id="section-appointments">
      <div class="section-header-row">
        <h2>Scheduled Appointments</h2>
        <span class="meta-text" id="totalAppointmentsText">Total Appointments: 0</span>
      </div>
      <div class="appointment-list" id="appointmentList"></div>
    </section>
  </main>

  <!-- Medical Records Modal -->
  <div class="modal-backdrop" id="recordsModal">
    <div class="modal">
      <div class="modal-header">
        <h3 id="recordsModalTitle">Patient â€“ Medical Records</h3>
        <button class="modal-close" data-close-records>âœ•</button>
      </div>
      <div class="modal-body-scroll">
        <div class="records-body" id="recordsModalBody">
          <!-- filled via JS -->
        </div>
      </div>
    </div>
  </div>

  <!-- Complete Check-up Modal -->
  <div class="modal-backdrop" id="completeModal">
    <div class="modal">
      <div class="modal-header">
        <h3 id="completeModalTitle">Complete Check-up</h3>
        <button class="modal-close" data-close-complete>âœ•</button>
      </div>
      <div class="modal-body-scroll">
        <form id="completeForm">
          <section class="complete-section highlight">
            <h4>Appointment Details</h4>
            <div class="complete-details-grid" id="completeDetailsHeader"></div>
          </section>

          <section class="complete-section">
            <h4>Vital Signs</h4>
            <div class="complete-grid">
              <label>Blood Pressure
                <input name="bp" />
              </label>
              <label>Heart Rate
                <input name="hr" />
              </label>
              <label>Temperature
                <input name="temp" />
              </label>
              <label>Weight
                <input name="weight" />
              </label>
              <label>Height
                <input name="height" />
              </label>
            </div>
          </section>

          <section class="complete-section">
            <div class="complete-grid">
              <label>Symptoms
                <textarea name="symptoms"></textarea>
              </label>
              <label>Diagnosis
                <textarea name="diagnosis"></textarea>
              </label>
              <label>Treatment Plan
                <textarea name="treatment"></textarea>
              </label>
              <label>Medications
                <textarea name="medications"></textarea>
              </label>
              <label>Additional Notes
                <textarea name="notes"></textarea>
              </label>
            </div>
          </section>

          <div class="modal-footer-row">
            <button type="button" class="btn-secondary" data-close-complete>Cancel</button>
            <button type="submit" class="btn-primary" id="btnComplete">Complete Check-up</button>
          </div>
        </form>
      </div>
    </div>
  </div>
{% endblock %} 
{% block script %}
<script>
  const LOGOUT_URL = {{ url_for('api_logout') | tojson }};
  const LOGIN_OFFICIAL_URL = {{ url_for('login_bp.login', role='official') | tojson }};
</script>
<script src="{{ url_for('static', filename='scripts/check_up_official.js') }}"></script>
{% endblock %}
